upstream:
  default:
    - tcp-tls:one.one.one.one
    - tcp-tls:1.0.0.1:853
    - https://cloudflare-dns.com/dns-query

upstreamTimeout: 5

conditional:
  mapping:
    ${SECRET_DOMAIN}: 192.168.42.5:53

bootstrapDns: tcp+udp:1.1.1.1

redis:
  address: redis-headless.system.svc:6379
  database: 2
  required: true
  connectionAttempts: 10
  connectionCooldown: 3s

blocking:
  blackLists:
    ads:
      - https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts
      - https://adaway.org/hosts.txt
      - https://v.firebog.net/hosts/lists.php?type=nocross
      - https://raw.githubusercontent.com/anudeepND/blacklist/master/adservers.txt
      - https://pgl.yoyo.org/adservers/serverlist.php?hostformat=hosts&showintro=0&mimetype=plaintext
      - https://raw.githubusercontent.com/bigdargon/hostsVN/master/hosts
      - https://raw.githubusercontent.com/jdlingyu/ad-wars/master/hosts
      - https://raw.githubusercontent.com/FadeMind/hosts.extras/master/add.2o7Net/hosts
      - https://raw.githubusercontent.com/crazy-max/WindowsSpyBlocker/master/data/hosts/spy.txt
      - https://www.github.developerdan.com/hosts/lists/ads-and-tracking-extended.txt
    noblock: [] 

  clientGroupsBlock:
    default:
      - ads
      - noblock
    192.168.1.129/32:
      - noblock
    192.168.1.224/32:
      - noblock
    192.168.1.249/32:
      - noblock
    192.168.10.129/32:
      - noblock
    192.168.10.224/32:
      - noblock
    192.168.10.249/32:
      - noblock

  blockType: nxDomain
  refreshPeriod: 0

clientLookup:
  upstream: tcp+udp:192.168.1.1
  singleNameOrder:
    - 2
    - 1

caching:
  prefetching: true
  minTime: 5
  maxTime: 5

prometheus:
  enable: true
  path: /metrics

tlsPort: 853
httpsPort: 443
certFile: /tls/tls.crt
keyFile: /tls/tls.key
httpPort: 4000
logLevel: trace