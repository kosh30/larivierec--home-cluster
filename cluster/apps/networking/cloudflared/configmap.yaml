---
apiVersion: v1
kind: ConfigMap
metadata:
  name: cloudflared-config
  namespace: networking
  labels:
    app.kubernetes.io/name: cloudflared
  annotations:
    reloader.stakater.com/match: "true"
data:
  config.yaml: |
    tunnel: ${SECRET_CLOUDFLARE_TUNNEL}
    credentials-file: /etc/cloudflared/creds.json
    no-autoupdate: true
    ingress:
    - hostname: "*.${SECRET_DOMAIN}"
      service: http://ingress-ingress-nginx-controller.networking
    - service: http_status:404